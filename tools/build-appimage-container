#!/bin/sh

if ! command -v podman > /dev/null 2>&1; then
	echo "podman is not in your path"
	exit 1
fi

CONTAINER_DIR=$(readlink -f "$(dirname "$0")")
CONTAINER_TAG="dbt8-appimage"

ARCH="$(uname -m)"

if [ "${ARCH}" = "arm64" ]; then
	ARCH="aarch64"
fi

cd "$CONTAINER_DIR/.." && \
		podman build \
				--isolation=chroot \
				--build-arg ARCH="${ARCH}" \
				-t $CONTAINER_TAG \
				-f Containerfile.appimage \
				.
